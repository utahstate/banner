<?xml version="1.0" encoding="UTF-8"?>
<beans 
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
	<bean id="appDataLayerConfigurationSettings" class="morphis.foundations.core.appdatalayer.configuration.AppDataLayerConfigurationSettings" init-method="initialize">
		<property name="defaultDataSetClass"	value="org.jdesktop.databuffer.DataSet"/>
		<property name="defaultManagerClass" 	value="morphis.foundations.core.appsupportlib.model.DBBusinessObject"/>
		<property name="defaultRowBaseClass" 	value="morphis.foundations.core.appdatalayer.data.BaseRowAdapter"/>

		<property name="defaultManagerKey">
			<bean class="morphis.foundations.core.appsupportlib.model.configuration.DBBusinessObjectItemConfiguration" init-method="initialize">
				<property name="name" value="#{ T(morphis.foundations.core.appsupportlib.model.configuration.DBBusinessObjectConfiguration).MODEL_ROWID }"/>
				<property name="type" value="java.sql.RowId"/>
				<property name="refreshValueAfter" value="Insert"/>
			</bean>
		</property>

		<property name="nonQueryableTypes">
			<map>
				<entry key="LongString" value="String"/>
			</map>
		</property>
		
		<property name="dbTypes">
			<bean
				class="morphis.foundations.core.appdatalayer.data.types.configuration.DbTypesData">
				<property name="structures">
					<list>
						<bean
							class="morphis.foundations.core.appdatalayer.data.types.configuration.DbStructData">
							<property name="id" value="NString" />
							<property name="typeName" value="morphis.foundations.core.types.NString" />
							<property name="dataSourceName" value="VARCHAR2" />
						</bean>
						<bean
							class="morphis.foundations.core.appdatalayer.data.types.configuration.DbStructData">
							<property name="id" value="NNumber" />
							<property name="typeName" value="morphis.foundations.core.types.NNumber" />
							<property name="dataSourceName" value="NUMBER" />
						</bean>
					</list>
				</property>
			</bean>
		</property>
	</bean>
	
	<bean id="appDataLayerSettings" class="morphis.foundations.core.appdatalayer.configuration.AppDataLayerSettings" init-method="initialize">

                <property name="envVars">
                        <map>
                                <entry key="PKG_XML" value="goktxml"/>
                                <entry key="useDBInstanceNLSSettings" value="${env.useDBInstanceNLSSettings}"/>

				<entry key="NLS_DATE_FORMAT">
					<value>${env.nls_date_format}</value>
				</entry>
				<entry key="NLS_CANONICAL_LANG">
					<value>${env.nls_canonical_lang}</value>
				</entry>
				<entry key="NLS_CANONICAL_CALENDAR">
					<value>${env.nls_canonical_calendar}</value>
				</entry>
				<entry key="NLS_SORT">
                    <value>${env.nls_sort}</value>
                </entry>
				<entry key="apidateFormat">
					<value>"${env.dateFormat}"</value>
				</entry>					
				<entry key="apidateTimeMask">
					<value>"${env.dateTimeMask}"</value>
				</entry>
            </map>
        </property>
	
		<property name="dataValueHandlerFactory">
			<bean class="morphis.foundations.core.appsupportlib.model.configuration.handlers.ValueConfigurationHandlerFactory"/>
		</property>
	
		<property name="dataSourceFactory" ref="dataSourceFactory"/>
		
		<property name="dataAccessFactory">
			<bean class="morphis.foundations.core.appdatalayer.data.impl.DBReaderDataAccessFactory"/>
		</property>

        <property name="dataTypeCreator">
			<bean class="morphis.foundations.core.appdatalayer.data.OracleDbTypeCreator"/>
        </property>

		<property name="valueSetSettings" ref="valueSetSettings"/>

		<property name="paginationSettings" ref="paginationSettings"/>

		<property name="sortSettings" ref="sortSettings"/>
	</bean>
	
	<bean id="dataBaseFactory" class="net.hedtech.general.common.data.OracleDatabaseFactory" scope="prototype">
		<property name="useLocking" 		value="false"/>
		<property name="connectionSettingsProvider">
			<bean class="morphis.workspace.forms.main.services.LoginConnectionStringSettingsProvider">
				<property name="defaultConnectionSettings" ref="connectionSettings"/>
			</bean>
		</property>
	</bean>
	
<!--
	<bean id="dataSourceFactory" class="morphis.foundations.core.appsupportlib.runtime.web.message.SessionInteractionDataSourceFactory">
		<property name="dataSourceProvider">
			<bean class="morphis.foundations.core.appdatalayer.data.Oracle12UCPDataSourceProvider">
				<property name="dataSourceProperties">
					<map>
						<entry key="InactivityTimeout" 		value="60"/>
						<entry key="PropertyCheckInterval"	value="60"/>
					</map>
				</property>
			</bean>
		</property>
	</bean>
	
	<bean id="connectionSettings" class="morphis.foundations.core.appdatalayer.configuration.OracleConnectionStringSettings" scope="prototype">
		<property name="proxyUser" 			value="${connection.proxy.user}"/>
		<property name="proxyPassword" 		value="${connection.proxy.password}"/>
		
		<property name="user"				value="${connection.user}"/>
		<property name="password" 			value="${connection.password}"/>
		
		<property name="host" 				value="${connection.host}"/>
		<property name="database" 			value="${connection.database}"/>
		
		<property name="provider" 			value="jdbc:oracle:thin"/>
		<property name="integratedSecurity" value="false"/>
	</bean>
-->

	<!-- externalized data sources -->


	<bean id="dataSourceFactory" class="morphis.foundations.core.appdatalayer.data.EnvironmentDataSourceFactory">
		<property name="dataSourceProvider">
			<bean class="morphis.foundations.core.appdatalayer.data.EnvironmentDataSourceProvider">
				<property name="dataSourceName" value="jdbc/bannerDataSource"/>
				<property name="dataSourceProcessor">	
				<bean class="morphis.foundations.core.appdatalayer.data.DbcpDataSourceProcessor"/>
				</property>
			</bean>
		</property>
	</bean>
		
	<bean id="connectionSettings" class="morphis.foundations.core.appdatalayer.configuration.OracleConnectionStringSettings" scope="prototype">
	</bean>


	<bean id="valueSetSettings" class="morphis.foundations.core.appdatalayer.configuration.ValueSetSettings">
		<property name="filterWildcardPrefix" value="true"/>
		<property name="filterWildcardSuffix" value="true"/>
	</bean>

	<bean id="paginationSettings" class="morphis.foundations.core.appdatalayer.configuration.PaginationSettings">
		<property name="maximumRows" value="100"/>
		<property name="businessObjectPagination">		
			<bean class="morphis.foundations.core.appdatalayer.data.pagination.configuration.ModelPagination">
				<property name="enabled" value="true" />
				<property name="maximumRows" value="20" />
			</bean>
		</property>
		<property name="valueSetPagination">		
			<bean class="morphis.foundations.core.appdatalayer.data.pagination.configuration.ModelPagination">
				<property name="enabled" value="true" />
				<property name="maximumRows" value="20" />
			</bean>
		</property>
	</bean>

	<bean id="sortSettings" class="morphis.foundations.core.appdatalayer.configuration.SortSettings">
		<property name="businessObjectSort" value="true"/>
	</bean>

	<bean
		class="morphis.foundations.core.util.configuration.StaticInitializerBeanFactoryPostProcessor">
		<property name="classes">
			<map>
				<entry key="org.jdesktop.databuffer.DataTableServices">
					<map>
						<entry key="provider">
							<bean class="org.jdesktop.databuffer.OracleDataTableServicesProvider"/>
						</entry>
					</map>
				</entry>
			
				<entry key="morphis.foundations.core.types.formatting.Formatting">
					<map>
						<entry key="defaultFormats">
							<bean class="morphis.foundations.core.types.formatting.DefaultFormats" init-method="initialize">
								<property name="dateMask" value="dd/MM/yyyy"/>
								<property name="dateTimeMask" value="dd/MM/yyyy HH:mm:ss"/>
								<property name="numberMask" value="0.000"/>
								<property name="lenient" value="false"/>
							</bean>
						</entry>

						<entry key="sourceFormatsProvider">
							<bean class="morphis.foundations.flavors.forms.types.formatting.OracleFormatsProvider"/>
						</entry>
					</map>
				</entry>
			</map>
		</property>
	</bean>
</beans>
